<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:title" content="ClaraCS" />
    <meta property="og:description" content="ClaraCS의 메인 페이지입니다." />
    <meta property="og:image" content="" />
    <title>ClaraCS – 지능형 CS 데이터 분석·인사이트 플랫폼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/upload.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- SheetJS 라이브러리 (Excel 파일 읽기용) -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <style>
      body {
        /* 원래 폰트로 돌리려면 아래 주석을 해제하세요 */
        /* font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif !important; */
        
        /* 현재 폰트 (Inter) */
        font-family: 'Inter', sans-serif;
        
        background-color: #010915;
        color: white;
      }
    </style>
</head>
<body class="min-h-screen bg-[#030c1b] text-white">
<div class="app">
  {% include 'includes/header.html' %}

  <!-- 메인 -->
  <main class="main full-width">

    <!-- 업로드 -->
    <section class="section" id="upload">
      <div class="head">
        <h2>데이터 업로드 (.xlsx / .csv / .xls)</h2>
        <div class="toolbar">
          <label style="display:inline-flex;align-items:center;gap:4px;">
            <input type="checkbox" id="select_all" />
            전체 선택
          </label>
          <button id="delete_file" class="btn">삭제</button>
          <button id="upload_file" class="btn save">파일 첨부</button>
          <input type="file" id="file_input" style="display: none;" multiple accept=".csv, .xlsx, .xls" />
        </div>
      </div>
      <div class="body">
        <div class="uploader">
          <br/>
          <div class="title" style="font-size: 19.8px;">여기에 파일을 끌어다 놓거나, 상단의 파일 첨부를 클릭하세요.</div>
          <div class="desc" style="margin-top:6px;">필수 컬럼 예시: 접수일, 채널, 고객ID/이메일, 본문, 담당자, 카테고리(선택)</div>
          <div class="file_list"></div>
          <div id="upload_summary" class="upload-summary"></div>
        </div>
        <p class="tip" style="margin-top:10px;">※ 권장 사항 : 각 채널당 파일 수는 3~5개, 총 용량 15MB 이내로 업로드해 주세요.</p>
        <div class="card" style="margin-top:16px;">
          <strong>미리보기 (상위 5행)</strong>
          <table class="table" style="margin-top:8px;" id="preview-table">
            <thead id="preview-thead">
              <!-- 업로드 후 동적으로 생성됩니다 -->
            </thead>
            <tbody id="preview-tbody">
              <tr><td colspan="10" style="text-align: center; padding: 40px; color: var(--muted);">파일을 업로드하면 데이터 미리보기가 표시됩니다.</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- 컬럼 매핑 -->
    <section class="section" id="mapping">
      <div class="head">
        <h2>컬럼 매핑</h2>
      </div>
      <div class="body grid cols-2">
        <div class="card">
          <div class="column-header" style="display: flex; align-items: center; justify-content: space-between;">
            <strong>Column Setting</strong>
            
            <div class="button-mapping-group" style="display: flex; gap: 8px;">
              <button class="btn edit">Edit</button>
              <button class="btn reset">초기화</button>
            </div>
          </div>
          <div class="grid" id="mapping-grid-container" style="margin-top:23px; clear:both;">
            <!-- 매핑 그리드는 JavaScript로 동적 생성됩니다 -->
          </div>
          <p class="tip" style="margin-top:3px;">※ 매핑 템플릿을 저장해두면 다음 업로드부터 자동 적용</p>
          <div class="add-btn-container">
            <button id="btn-add-row" class="btn add-row-btn">+</button>
          </div>
        </div>
        <div class="card">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
            <strong>유효성/정합성 체크</strong>
            <button id="save_btn" class="btn save">검증 및 업로드</button>
          </div>
          <div id="validation_result" class="validation-result">
            <p class="tip">파일을 선택한 후 검증 및 업로드 버튼을 클릭하면 유효성 검사가 시작됩니다.</p>
          </div>
        </div>
      </div>
    </section>

  </main>
</div>
<script type="text/javascript" src="{{ url_for('static', filename='js/common.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/upload.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/mapping.js') }}"></script>
</body>
</html>
